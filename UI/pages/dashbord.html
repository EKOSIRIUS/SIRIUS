<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EKO - Raporlar</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="../plugins/fontawesome-free/css/all.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../dist/css/adminlte.css">
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="../index.html" class="nav-link">Anasayfa</a>
      </li>
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Navbar Search -->
      <li class="nav-item">
        <a class="nav-link" data-widget="navbar-search" href="#" role="button">
          <i class="fas fa-search"></i>
        </a>
        <div class="navbar-search-block">
          <form class="form-inline">
            <div class="input-group input-group-sm">
              <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
              <div class="input-group-append">
                <button class="btn btn-navbar" type="submit">
                  <i class="fas fa-search"></i>
                </button>
                <button class="btn btn-navbar" type="button" data-widget="navbar-search">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          </form>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="raporlar.html" class="brand-link">
      <img src="../dist/img/ekofaktoring.png" alt="AdminLTE Logo" class="brand-image " >
      <span class="brand-text font-weight-light" style="color: white;">Eko Faktoring</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->
      <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="../dist/img/user.jpg" class="img-circle elevation-2" alt="User Image">
        </div>
        <div class="info">
          <a href="#" class="d-block">Kullanıcı</a>
        </div>
      </div>


      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <li class="nav-item">
            <a href="../index.html" class="nav-link">
              <i class="nav-icon fas fa-industry"></i>
              <p>
                Raporlar
              </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link active">
              <i class="nav-icon fas fa-tachometer-alt"></i>
              <p>
                KPI
              </p>
            </a>
          </li>
          
          <li class="nav-item">
            <a href="HedefGiris.html" class="nav-link">
              <i class="nav-icon fas fa-edit"></i>
              <p>
                Hedef İşlemleri
              </p>
            </a>
          </li>

          <li class="nav-item">
            <a href="data.html" class="nav-link">
              <i class="nav-icon fas fa-edit"></i>
              <p>
                Müşteri Risk
              </p>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </aside>


  <div class="content-wrapper">

    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0">Eko Faktoring A.Ş. - Bilgi İşlem</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Anasayfa</a></li>
              <li class="breadcrumb-item active">KPI</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>

    <section class="content">
      <div class="container-fluid">

        <div class="row">

          <div class="col-md-6 ">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">İşlem Adetleri</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Gelen</th>
                      <th>Gerçekleşen</th>
                    </tr>
                    </thead>
                  <tbody>
                    <tr>
                      <td>İşlem Adedi(Günlük)</td>
                      <td><span class="badge bg-primary"  style="font-size:16px;"id="GelenIslemAdediGunluk">0</span></td>
                      <td><span class="badge bg-primary"  style="font-size:16px;"id="GelenIslemAdediGunlukGerceklesen">0</span></td>
                    </tr>
                    <tr>
                      <td>İşlem Adedi(Aylık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="GelenIslemAdediAylik">0</span></td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="GelenIslemAdediAylikGerceklesen">0</span></td>
                    </tr>
                    <tr>
                      <td>İşlem Adedi(Yıllık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="GelenIslemAdediYillik">0</span></td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="GelenIslemAdediYillikGerceklesen">0</span></td>
                    </tr>
                    
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
            <div class="card ">
              <div class="card-header">
                <h3 class="card-title">Bordro Tutarları</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <table class="table table-striped">
                  <tbody>
                    <tr>
                      <td>Toplam Bordro Tutarı(Günlük)</td>
                      <td><span class="badge bg-primary"  style="font-size:16px;"id="ToplamBordroTutariGunluk">0</span></td>
                    </tr>
                    <tr>
                      <td>Toplam Bordro Tutarı(Aylik)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="ToplamBordroTutariAylik">0</span></td>
                    </tr>
                    <tr>
                      <td>Toplam Bordro Tutarı(Yıllık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="ToplamBordroTutariYillik">0</span></td>
                    </tr>
                    
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Müşteri Ziyaret(Aylık)</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <table class="table table-striped">
                  <tbody  id="ZiyaretTablosu">
                    <tr>
                      <td>Toplam</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="ToplamZiyaretAdedi">0</span></td>
                    </tr>
                    
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
          </div>

          <div class="col-md-6 ">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Duruma Göre Bordro Tutarı</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <table class="table table-striped">
                  <tbody>
                    <tr>
                      <td>Onaylanan(Bordro Tutar)(Günlük)</td>
                      <td><span class="badge bg-primary"  style="font-size:16px;"id="OnaylananIslemGunluk">0</span></td>
                    </tr>
                    <tr>
                      <td>Onaylanmayan(Bordro Tutar)(Günlük)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="OnaylanmayanIslemGunluk">0</span></td>
                    </tr>
                    <tr>
                      <td>Onaylanan(Bordro Tutar)(Aylık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="OnaylananIslemAylik">0</span></td>
                    </tr>
                    <tr>
                      <td>Onaylanmayan(Bordro Tutar)(Aylık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="OnaylanmayanIslemAylik">0</span></td>
                    </tr>
                    <tr>
                      <td>Onaylanan(Bordro Tutar)(Yıllık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="OnaylananIslemYillik">0</span></td>
                    </tr>
                    <tr>
                      <td>Onaylanmayan(Bordro Tutar)(Yıllık)</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="OnaylanmayanIslemYillik">0</span></td>
                    </tr>
                    
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Yeni Müşteri Adedi</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Aylık</th>
                      <th>Kümüle</th>
                    </tr>
                    </thead>
                  <tbody>
                    <tr>
                      <td>Yeni Müşteri Adedi</td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="yeniMusteriAdedi">0</span></td>
                      <td><span class="badge bg-primary" style="font-size:16px;" id="yeniMusteriAdediKumule">0</span></td>
                    </tr>
                    
                  </tbody>
                </table>
              </div>
              <!-- /.card-body -->
            </div>
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Hedef Tablosu</h5>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="remove">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <div class="row">
                  <!-- /.col -->
                  <div class="col-md-12" id="HedefHeader">
                    <p class="text-center">
                      <strong>Hedef Değerler</strong>
                    </p>

                    
                    <!-- /.progress-group -->
                  </div>
                  <!-- /.col -->
                </div>
                <!-- /.row -->
              </div>
              <!-- ./card-body -->
              <div class="card-footer">
                <p class="text-center">
                  <strong>Değişim Durumu</strong>
                </p>
                <div class="row" id="HedefFooter">
                  
                </div>
                <!-- /.row -->
              </div>
              <!-- /.card-footer -->
            </div>
          </div>
          
        </div>

        <div class="row">
          <!-- Left col -->
          <div class="col-md-12">

            <div class="card">
              <div class="card-header border-transparent">
                <h3 class="card-title">Pazarlamacı Bilgileri</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                  <button type="button" class="btn btn-tool" data-card-widget="remove">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table m-0"  id="pazarlamaciBilgileri">
                    <thead>
                    <tr>
                      <th>Şube</th>
                      <th>Adi Soyadı</th>
                      <th>Plasman</th>
                      <th>İşlem Hacmi</th>
                    </tr>
                    </thead>
                    <tbody>


                    </tbody>
                  </table>
                </div>
                <!-- /.table-responsive -->
              </div>

            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->

          
          <!-- /.col -->
        </div>

        <div class="row">
          <!-- Left col -->
          <div class="col-md-12">

            <div class="card">
              <div class="card-header border-transparent">
                <h3 class="card-title">Son 10 İşlem</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                  <button type="button" class="btn btn-tool" data-card-widget="remove">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table m-0"  id="lastProceses">
                    <thead>
                    <tr>
                      <th>İslem No</th>
                      <th>Firma No</th>
                      <th>Firma Adi</th>
                      <th>Temsilci</th>
                      <th>Bordro Tutar</th>
                      <th>Durum</th>
                    </tr>
                    </thead>
                    <tbody>


                    </tbody>
                  </table>
                </div>
                <!-- /.table-responsive -->
              </div>

            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->

          
          <!-- /.col -->
        </div>


      </div>
    </section>

    

  </div>

  <!-- Main Footer -->
  <footer class="main-footer">
    <!-- Default to the left -->
    <strong>Eko Faktoring &copy; 2023 <a href="https://www.ekofactoring.com"></a></strong> Tüm Hakları Saklıdır.
  </footer>
</div>

<script src="../plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- overlayScrollbars -->
<script src="../plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
<!-- AdminLTE App -->
<script src="../dist/js/adminlte.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
<!-- PAGE PLUGINS -->
<!-- jQuery Mapael -->
<script src="../plugins/jquery-mousewheel/jquery.mousewheel.js"></script>
<script src="../plugins/raphael/raphael.min.js"></script>
<script src="../plugins/jquery-mapael/jquery.mapael.min.js"></script>
<script src="../plugins/jquery-mapael/maps/usa_states.min.js"></script>
<!-- ChartJS -->
<script src="../plugins/chart.js/Chart.min.js"></script>


  <script>

    const depUrl = 'https://siriusapi.ekofactoring.com';
    const testUrl = 'https://localhost:7105';
    

    const aktifUrl = testUrl;


    let ToplamBordroTutari = [];
    let IslemAdedi = [];
    let IslemAdediGercelesen = [];
    let OnayDurum = [];
    
    const gelenGunluk = document.getElementById('GelenIslemAdediGunluk');
    const gelenGunlukGerceklesen = document.getElementById('GelenIslemAdediGunlukGerceklesen');
    const gelenAylik = document.getElementById('GelenIslemAdediAylik');
    const gelenAylikGerceklesen = document.getElementById('GelenIslemAdediAylikGerceklesen');
    const gelenYillik = document.getElementById('GelenIslemAdediYillik');
    const gelenYillikGerceklesen = document.getElementById('GelenIslemAdediYillikGerceklesen');

    const toplamGunluk = document.getElementById('ToplamBordroTutariGunluk');
    const toplamAylik = document.getElementById('ToplamBordroTutariAylik');
    const toplamYillik = document.getElementById('ToplamBordroTutariYillik');

    const onaylananGunluk = document.getElementById('OnaylananIslemGunluk');
    const onaylanmayanGunluk = document.getElementById('OnaylanmayanIslemGunluk');
    const onaylananAylik = document.getElementById('OnaylananIslemAylik');
    const onaylanmayanAylik = document.getElementById('OnaylanmayanIslemAylik');
    const onaylananYillik = document.getElementById('OnaylananIslemYillik');
    const onaylanmayanYillik = document.getElementById('OnaylanmayanIslemYillik');

    const yeniMusteriAdedii = document.getElementById('yeniMusteriAdedi');
    const yeniMusteriAdediKumule = document.getElementById('yeniMusteriAdediKumule');

    const ziyaretTablosu =document.getElementById("ZiyaretTablosu");
    const ziyaretTablosuToplam =document.getElementById("ToplamZiyaretAdedi");

    
      let hedefPlasman = [];
      let hedefGelir = [];
      let hedefIslemHacmi = [];
      let hedefYeniIslemHacmi = [];

      let hedefAciklama = [];
      let hedefDegerler = [];

      const data1 = fetch(aktifUrl+'/api/Raporlar/PazarlamaPerformans?yil=2023').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
            hedefPlasman.push(element.plasman);
            hedefGelir.push(element.gelir);
            hedefIslemHacmi.push(element.islemHacmi);
            hedefYeniIslemHacmi.push(element.yeniIslemMusteriTutari);
          });
          HedefHeader()
          HedefFooter()
    });
      const data9 = fetch(aktifUrl+'/api/Raporlar/HedefData').then(response => response.json()).then(function(datas){
        datas.forEach(element => {
            hedefDegerler.push(element.hedef);
            });
            
      });

      function HedefHeader() {
      var listeRef = document.getElementById('HedefHeader');
        //insert Row
        listeRef.innerHTML += 
        "<div class='progress-group'>Plasman"+
          "<span class='float-right'><b>"+hedefPlasman[hedefPlasman.length-1].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</b>/"+hedefDegerler[0].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+ "</span>"+
          "<div class='progress progress-sm'>"+
            "<div class='progress-bar bg-primary' style='width: " +Math.round(hedefPlasman[hedefPlasman.length-1]*100/hedefDegerler[0]) +"%'></div>"+
          "</div>"+
        "</div>"+
        "<div class='progress-group'>Gelir"+
          "<span class='float-right'><b>"+hedefGelir[hedefGelir.length-1].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</b>/"+hedefDegerler[1].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+ "</span>"+
          "<div class='progress progress-sm'>"+
            "<div class='progress-bar bg-warning' style='width: " +Math.round(hedefGelir[hedefGelir.length-1]*100/hedefDegerler[1]) +"%'></div>"+
          "</div>"+
        "</div>"+
        "<div class='progress-group'>İşlem Hacmi"+
          "<span class='float-right'><b>"+hedefIslemHacmi[hedefIslemHacmi.length-1].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</b>/"+hedefDegerler[2].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+ "</span>"+
          "<div class='progress progress-sm'>"+
            "<div class='progress-bar bg-success' style='width: " +Math.round(hedefIslemHacmi[hedefIslemHacmi.length-1]*100/hedefDegerler[2]) +"%'></div>"+
          "</div>"+
        "</div>"+
        "<div class='progress-group'>Yeni İşlem Hacmi"+
          "<span class='float-right'><b>"+hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-1].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</b>/"+hedefDegerler[3].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+ "</span>"+
          "<div class='progress progress-sm'>"+
            "<div class='progress-bar bg-danger' style='width: " +Math.round(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-1]*100/hedefDegerler[3]) +"%'></div>"+
          "</div>"+
        "</div>"
        ;

    }

    function HedefFooter(){
      var plasman = parseInt(Math.floor(((Math.floor(hedefPlasman[hedefPlasman.length-1])-Math.floor(hedefPlasman[hedefPlasman.length-2]))/Math.floor(hedefPlasman[hedefPlasman.length-2]))*100)); 
      let gelir =  Math.floor(((Math.floor(hedefGelir[hedefGelir.length-1])-Math.floor(hedefGelir[hedefGelir.length-2]))/Math.floor(hedefGelir[hedefGelir.length-2]))*100)

      let islemhacmi =  Math.floor(((Math.floor(hedefIslemHacmi[hedefIslemHacmi.length-1])-Math.floor(hedefIslemHacmi[hedefIslemHacmi.length-2]))/Math.floor(hedefIslemHacmi[hedefIslemHacmi.length-2]))*100)

      let yenislemhacmi =  Math.floor(((Math.floor(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-1])-Math.floor(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-2]))/Math.floor(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-2]))*100)

      var listeRef = document.getElementById('HedefFooter');
        //insert Row
        listeRef.innerHTML += 
        "<div class='col-sm-3 col-6'>"+
          "<div class='description-block border-right'>"+
            degerKontrol(plasman)
            +plasman+"%</span>"+
            "<h5 class='description-header'>"+(Math.floor(hedefPlasman[hedefPlasman.length-1])-
              Math.floor(hedefPlasman[hedefPlasman.length-2])).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</h5>"+
            "<span class='description-text'>Plasman</span>"+
          "</div>"+
        "</div>"+
        "<div class='col-sm-3 col-6'>"+
          "<div class='description-block border-right'>"+
            degerKontrol(gelir)
            +gelir+"%</span>"+
            "<h5 class='description-header'>"+(Math.floor(hedefGelir[hedefGelir.length-1])-
              Math.floor(hedefGelir[hedefGelir.length-2])).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</h5>"+
            "<span class='description-text'>Gelir</span>"+
          "</div>"+
        "</div>"+
        "<div class='col-sm-3 col-6'>"+
          "<div class='description-block border-right'>"+
            degerKontrol(islemhacmi)
            +islemhacmi+"%</span>"+
            "<h5 class='description-header'>"+(Math.floor(hedefIslemHacmi[hedefIslemHacmi.length-1])-
              Math.floor(hedefIslemHacmi[hedefIslemHacmi.length-2])).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</h5>"+
            "<span class='description-text'>İşlem Hacmi</span>"+
          "</div>"+
        "</div>"+
        "<div class='col-sm-3 col-6'>"+
          "<div class='description-block border-right'>"+
            degerKontrol(yenislemhacmi)
            +plasman+"%</span>"+
            "<h5 class='description-header'>"+(Math.floor(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-1])-
              Math.floor(hedefYeniIslemHacmi[hedefYeniIslemHacmi.length-2])).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</h5>"+
            "<span class='description-text'>Yeni İşlem Hacmi</span>"+
          "</div>"+
        "</div>";
    }

    function degerKontrol(deger){
      let addText ;
      if (deger == 0) {
              addText="<span class='description-percentage text-warning'><i class='fas fa-caret-left'></i>"
            }
            else if(deger < 0){
              addText="<span class='description-percentage text-danger'><i class='fas fa-caret-down'></i>"
            }
            else if(deger > 0){
              addText="<span class='description-percentage text-success'><i class='fas fa-caret-up'></i>"
            }
            return addText;
    }


    let ziyateAdi = []
    let ziyaretAdet = []
    const data8 = fetch(aktifUrl+'/api/Raporlar/Ziyaret').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
            ziyateAdi.push(element.adi);
            ziyaretAdet.push(element.ziyaret);

          });
          let veri =0;
          for (let index = 0; index < ziyaretAdet.length; index++) {
            veri=veri+ parseInt(ziyaretAdet[index].toString())
          }
          ziyaretTablosuToplam.innerText =veri;
          pazarlamaciZiyaret()
          
          
    });


    function pazarlamaciZiyaret() {
      var tableRef = document.getElementById('ZiyaretTablosu');
      for (let index = 0; index < ziyateAdi.length; index++){
        //insert Row
          tableRef.innerHTML += 
        "<td>" + ziyateAdi[index]+"</td>" + 
        "<td><span class='badge bg-primary' style='font-size:16px;'>" +ziyaretAdet[index]+"</span></td>";

        

    }
    }

    let yeniMusteriAdedi=[];
    const data7 = fetch(aktifUrl+'/api/Raporlar/YeniMusteri').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
            yeniMusteriAdedi.push(element.adet);

          });
          let veri =0;
          for (let index = 0; index < yeniMusteriAdedi.length; index++) {
            veri=veri+ parseInt(yeniMusteriAdedi[index].toString())
          }
          yeniMusteriAdediKumule.innerText =veri;
          yeniMusteriAdedii.innerText =yeniMusteriAdedi[yeniMusteriAdedi.length-1];
          
          
    });

    const data = fetch(aktifUrl+'/api/Raporlar/ToplamBordroTutari').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
            ToplamBordroTutari.push(element.toplamBordroTutari);
          });
          toplamGunluk.innerHTML =ToplamBordroTutari[0].toLocaleString(undefined,{ minimumFractionDigits: 2 });
          toplamAylik.innerHTML =ToplamBordroTutari[1].toLocaleString(undefined,{ minimumFractionDigits: 2 });
          toplamYillik.innerHTML =ToplamBordroTutari[2].toLocaleString(undefined,{ minimumFractionDigits:2 });
    });

    const data2 = fetch(aktifUrl+'/api/Raporlar/IslemAdedi').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
            IslemAdedi.push(element.islemAdedi);
            IslemAdediGercelesen.push(element.gerceklesen);
          });
          gelenGunluk.innerText =IslemAdedi[0].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          gelenGunlukGerceklesen.innerText =IslemAdediGercelesen[0].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          gelenAylik.innerText =IslemAdedi[1].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          gelenAylikGerceklesen.innerText =IslemAdediGercelesen[1].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          gelenYillik.innerText =IslemAdedi[2].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          gelenYillikGerceklesen.innerText =IslemAdediGercelesen[2].toLocaleString(undefined,{ minimumFractionDigits: 0 }).toString();
          
    });

    const data3 = fetch(aktifUrl+'/api/Raporlar/OnayDurumuTutari').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
        OnayDurum.push(element.islemBordroTutari);
          });
          onaylananGunluk.innerHTML =parseInt(OnayDurum[0]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
          onaylanmayanGunluk.innerHTML =parseInt(OnayDurum[1]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
          onaylananAylik.innerHTML =parseInt(OnayDurum[2]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
          onaylanmayanAylik.innerHTML =parseInt(OnayDurum[3]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
          onaylananYillik.innerHTML =parseInt(OnayDurum[4]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
          onaylanmayanYillik.innerHTML =parseInt(OnayDurum[5]).toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString();
    });     


    let IslemNo = [];
    let FirmaNo = [];
    let FirmaAdi = [];
    let TemsilciAdi = [];
    let BordroTutar = [];
    let Durum = [];

    const data4 = fetch(aktifUrl+'/api/Raporlar/SonIslemler').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
        IslemNo.push(element.islemno);
        FirmaNo.push(element.firmano);
        FirmaAdi.push(element.firmaadi);
        TemsilciAdi.push(element.adi);
        BordroTutar.push(element.bordrotutar);
        Durum.push(element.bipekkod4);
          });
          sonIslemlerDoldur();
    });


    function sonIslemlerDoldur() {
      var tableRef = document.getElementById('lastProceses').getElementsByTagName('tbody')[0];
      for (let index = 0; index < IslemNo.length; index++){
        //insert Row
        if(Durum[index]== "Onaylanmadı"){
          tableRef.insertRow().innerHTML = 
        "<td><span style='font-size:14px;'>" + IslemNo[index]+"</span></td>" + 
        "<td><span style='font-size:14px;'>" +FirmaNo[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +FirmaAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +TemsilciAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px; font-weight: bold;'>" +BordroTutar[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>"+
        "<td><span style='font-size:14px;' class='badge badge-danger'>" +Durum[index]+"</span></td>";
        }
        else if(Durum[index]== "Onay Bekliyor"){
          tableRef.insertRow().innerHTML = 
        "<td><span style='font-size:14px;'>" + IslemNo[index]+"</span></td>" + 
        "<td><span style='font-size:14px;'>" +FirmaNo[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +FirmaAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +TemsilciAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px; font-weight: bold;'>" +BordroTutar[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>"+
        "<td><span style='font-size:14px;' class='badge badge-warning'>" +Durum[index]+"</span></td>";
        }
        else if(Durum[index]== "Onaylandı"){
          tableRef.insertRow().innerHTML = 
        "<td><span style='font-size:14px;'>" + IslemNo[index]+"</span></td>" + 
        "<td><span style='font-size:14px;'>" +FirmaNo[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +FirmaAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +TemsilciAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px; font-weight: bold;'>" +BordroTutar[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>"+
        "<td><span style='font-size:14px;' class='badge badge-success'>" +Durum[index]+"</span></td>";
        }
        else if(Durum[index]== "Ödeme Yapıldı"){
          tableRef.insertRow().innerHTML = 
        "<td><span style='font-size:14px;'>" + IslemNo[index]+"</span></td>" + 
        "<td><span style='font-size:14px;'>" +FirmaNo[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +FirmaAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px;'>" +TemsilciAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px; font-weight: bold;'>" +BordroTutar[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>"+
        "<td><span style='font-size:14px;' class='badge badge-info'>" +Durum[index]+"</span></td>";
        }
        
    }
    }

    let pSube = [];
    let pAdi = [];
    let pDepartman = [];
    let pPlasman= [];
    let pIslemHacmi = [];
    const data6 = fetch(aktifUrl+'/api/Raporlar/PazarlamaciBilgileri').then(response => response.json()).then(function(datas){
      datas.forEach(element => {
        pSube.push(element.aciklama);
        pAdi.push(element.adi);
        pDepartman.push(element.departman);
        pPlasman.push(element.plasman);
        pIslemHacmi.push(element.islemHacmi);
          });
          pazarlamaciIslemHacmi();
    });

    function pazarlamaciIslemHacmi() {
      var tableRef = document.getElementById('pazarlamaciBilgileri').getElementsByTagName('tbody')[0];
      for (let index = 0; index < pSube.length; index++){
        //insert Row
          tableRef.insertRow().innerHTML = 
        "<td><span style='font-size:14px;'>" + pSube[index]+"</span></td>" + 
        "<td><span style='font-size:14px;'>" +pAdi[index]+"</span></td>"+
        "<td><span style='font-size:14px; font-weight: bold;'>" +pPlasman[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>"
         +"<td><span style='font-size:14px; font-weight: bold;'>" +pIslemHacmi[index].toLocaleString(undefined,{ minimumFractionDigits: 2 }).toString()+"</span></td>";
        

    }
    }
  </script>
</body>
</html>